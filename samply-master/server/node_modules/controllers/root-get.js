'use strict';

const fs = require('fs');
const mimetypes = require('../mimetypes');

const rootGet = (data) => {
  if (fs.statSync(data.shdata.paths.root_view).isFile()) {
    data.response.writeHead(200, {'content-type': mimetypes['views']});
    data.response.end(fs.readFileSync(data.shdata.paths.root_view, 'utf8'));
    return Promise.resolve({
      success: true,
      details: {
        status: 200,
        file:   data.shdata.paths.root_view,
        message: 'OK'
      }
    });
  }

  data.response.writeHead(404, {'content-type': 'text/plain'});
  data.response.end(`Resource ${data.paths.root_view} not found.`);
  return Promise.resolve({
    success: false,
    details: {
      status: 404,
      file:   data.shdata.paths.root_view,
      message: 'Resource not found'
    }
  });

}

module.exports = rootGet;
